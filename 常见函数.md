# sql-learning in week5(using MySQL)
<h2>常见函数</h2>
类似于Java中的方法，将一组逻辑语句封装在方法中，对外只暴露方法名。<br/>
好处:
<ol>
<li>隐藏了实现细节</li>
<li>提高了代码的重用性</li>
</ol>
调用:select 函数名(实参列表) (当函数参数用到了表中的字段时加上语句 from 表名);<br/>
分类:<ol>
<li>单行函数,如:concat、length、ifnull（主要做处理，给参数返回值）</li>
<li>分组函数（统计函数），（主要做统计，给一组参数，返回一个值）</li>
</ol>
<h3>单行函数</h3>
分类:<ol>
<li>字符函数</li>
<li>数学函数</li>
<li>日期函数</li>
<li>其他函数（补充）</li>
<li>流程控制函数(补充)</li>
</ol>
<h4>字符函数</h4>
<ol>
<li>获取参数集的字节数:select length(参数)   (参数类型为str)<br/>
	如:SELECT LENGTH('join'); 输出结果为4<br/>
	<strong>注意汉字的字节数可能不同</strong></li>
<li>拼接字符串:select concat() from 表名;<br/>
	如：SELECT CONCAT(last_name,'?',first_name) FROM employees;</li>
<li>大小写:select upper/lower(参数)<br/>
	如：SELECT CONCAT(UPPER(last_name),LOWER(first_name)) AS 姓名 FROM employees;</li>
<li>截取字符（该函数存在四个重载）：select substr/substring(参数)<br/>
	<strong>注意substr的起始位置标号永远为1</strong>
	<ol>
	<li>第一个用法:select substr(字符串,位置) 截取从位置开始往后的所有字符(包括该位置)<br/>
	如：SELECT SUBSTR('芜湖起飞咯',2); 结果为湖起飞咯</li>
	<li>第二个用法:select substr(字符串，位置，长度) 截取从位置开始（包括该位置）往后长度为n的字符<br/>
	如：SELECT SUBSTR('芜湖起飞咯',2,4); 输出为：湖起飞咯</li>
	</ol>
</li>
<li>返回子串在母串中的起始索引（如果多次出现返回第一次出现的位置，找不到返回0）select instr(母串,子串);<br/>
	如：SELECT INSTR('芜湖起飞','起飞'); 输出为3
</li>
<li>去字符串前后某些字符:select trim(参数)<br/>
	<ol>
	<li>第一种用法：去前后空格<br/>
	如：SELECT TRIM('   非   打 大萨达翁   '); 输出为：非   打 大萨达翁 </li>
	<li>第二种用法：从第一个字符开始检索，只要出现了相同的字符（或字符串）就删去，出现了第一个不匹配的字符（或字符串）就停止，从最后一个字符（字符串）也相同的操作一遍<br/>
	如：SELECT TRIM('ab' FROM 'abaabab  非  aa 打 aa aa大萨达翁  baabaaaab'); 输出为：aabab  非  aa 打 aa aa大萨达翁  baabaaa<br/>
	如:SELECT TRIM('ab' FROM ' abaabab  非  aa 打 aa aa大萨达翁  baabaaaab '); 则不会删去任何一个字符，因为第一个跟最后一个字符都是空格</li>
	</ol>	
</li>
<li>用指定的字符左填充：select lpad(字符串,长度,填充字符串);  (长度为字符串加填充字符串的总长度，若长度小于任意一个字符串，则对字符串进行截断（以左边为1开始截断）)<br/>
	如：SELECT LPAD('起飞咯',1,'*'); 结果为：起<br/>
	如：SELECT LPAD('起飞咯',5,'*');结果为：**起飞咯
</li>
<li>用指定字符串右填充：select rpad(字符串,长度,填充字符串);</li>
<li>替换（替换对象重复时所有替换对象都会被替换）：select replace(字符串,被替换对象,替换字符);<br/>
	如：SELECT REPLACE('123love321',1,5); 输出为：523love325
</li>
</ol>
<h4>数学函数</h4>
<ol>
<li>四舍五入:select round(参数)<br/>
	SELECT ROUND(-5.2); 输出-5<br/>
	SELECT ROUND(-5.5); 输出-6<br/>
	SELECT ROUND(5.2); 输出5
</li>
<li>向上取整（返回大于等于参数的最小整数）:select seil(参数)<br/>
	SELECT CEIL(-1.5); 输出-1
</li>
<li>向下取整（返回小于等于该参数的最大整数）：select floor(参数)<br/>
	SELECT FLOOR(-7.1); 输出为-8
</li>
<li>截断（小数点后保留几位）：select truncate(参数1,参数2);<br/>
	SELECT TRUNCATE(51.98524,1); 输出为51.9
</li>
<li>取模（正负号与参数相同）：select mod(参数1,参数2);<br/>
	SELECT MOD(-10,-3); 输出为-1
</ol>
<h4>日期函数</h4>
参数的类型为日期
<ol>
<li>返回当前系统日期+时间:select now();
	select now();    输出为2021-7-16 21:28:16</li>
<li>返回当前系统日期（不包括时间）：select curdate();<br/>
	select curdate();  输出为2021-7-16
</li>
<li>返回当前时间（不包括日期）：select curtime();<br/>
	SELECT CURTIME(); 输出为21:30:21</li>
<li>还可以用select year/month/day(参数);单独输出月日年<br/>
	在year/month/day后面加上name可以输出英文的月日年</li>
<li>将日期格式的字符以某种特定的方式解析：select str_to_date(参数,指定格式);<br/>
	<img src="https://github.com/SaltyFishy/sql-language/blob/week5/%E8%A1%A8.jpg" alt="表" title="表"><br/>
	SELECT STR_TO_DATE('1968-5-7','%Y-%c-%d'); 输出为1968-05-07</li>
<li>将日期转换成字符：select date_format(参数，指定格式)<br/>
	SELECT DATE_FORMAT('2018/6/6','%Y年%c月%d日'); 输出为：2018年6月06日</li>
</ol>
<h4>其他函数（补充）</h4>
<ol>
<li>查看版本号：select version();</li>
<li>查看当前所在数据库：select detabase();</li>
<li>查看用户：select version();</li>
</ol>
<h4>流程控制函数（补充）</h4>
<ol>
<li>if 实现if else的效果<br/>
	if(判断表达式,为真的结果，为假的结果);<br/>
	SELECT IF(10>5,'big','small');  输出big
</li>
<li>case结构
	<ol>
	<li>方法一：实现switch case<br/>
	case 要判断字段或表达式<br/>
	when 常量1 then 值或语句（语句要分号，值不用）<br/>
	....<br/>
	else 要显示的值或语句<br/>
	end<br/>
	例：查询员工的工资<br/>
	部门号=30，显示工资为1.1倍<br/>
	部门号=40，显示工资为1.2倍<br/>
	部门号=50，显示工资为1.5倍<br/>
	其他部门，显示的工资为原工资<br/>
	SELECT department_id, salary AS 工资,<br/>
	CASE department_id<br/>
	WHEN 30 THEN salary*1.1<br/>
	WHEN 40 THEN salary*1.2<br/>
	WHEN 50 THEN salary*1.5<br/>
	ELSE salary <br/>
	END AS new_salary<br/>
	FROM employees;<br/>
	</li>
	<li>方法二： 类似于多重if<br/>
	case<br/>
	when 条件1 then 显示的值或语句（语句要分号值不用）<br/>
	...<br/>
	else 要显示的值或语句<br/>
	end<br/>
	例：查询员工的工资情况<br/>
	如果工资大于2w，显示A级别<br/>
	如果工资大于1.5w，显示B级别<br/>
	如果工资大于1w，显示C级别<br/>
	否则输入D级别<br/>
	SELECT salary,<br/>
	CASE<br/>
	WHEN salary>20000 THEN 'A'<br/>
	WHEN salary>15000 THEN 'B'<br/>
	WHEN salary>10000 THEN 'C'<br/>
	ELSE 'D'<br/>
	END<br/>
	FROM employees;	<br/>
	</li>
</li>
</ol>
<h3>单行函数总结</h3>
<ol>
<li>字符函数:
	<ul>
	<li>length</li>
	<li>concat</li>
	<li>substr</li>
	<li>upper/lower</li>
	<li>instr</li>
	<li>ipad/lpad</li>
	<li>trim</li>
	<li>replace</li>
	</ul>
</li>
<li>数学函数：
	<ul>
	<li>round</li>
	<li>ceil/floor</li>
	<li>mod</li>
	<li>truncate</li>
	</ul>
</li>
<li>日期函数：
	<ul>
	<li>now</li>
	<li>year/month/day/hour/minute/second</li>
	<li>yearname/monthname/dayname</li>
	<li>curdate</li>
	<li>curtime</li>
	<li>str_to_date</li>
	<li>date_format</li>
	</ul>
</li>
<li>其他函数：
	<ul>
	<li>version</li>
	<li>database</li>
	<li>user</li>
	</ul>
</li>
<li>控制函数
	<ul>
	<li>if</li>
	<li>case</li>
	</ul>
</li>
</ol>
